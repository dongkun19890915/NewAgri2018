<!--
****************************************************************************
* DESC       ：国元农险理赔并案管理-立案任务处理页面
* AUTHOR     ：国元农险项目组
* CREATEDATE ：2017/12/8
* MODIFYLIST ：Name        Date        Reason/Contents
* --------------------------------------------------------
****************************************************************************
-->
<div class="section">
  <div class="content_div content1-div">
    <div class='damage clearfix border-all'>
      <span class='fl damage_span' ng-click="openCommunicationLayer()">理赔沟通</span>
      <span class='fl damage_span' ng-click="openEleDocumentLayer()">电子单证</span>
    </div>
    <div class="queryCriteria mt20 mo-heigh">
      <span class="queryCriteria_title">
                    <label>查勘定损</label>
                </span>
      <div class="condition_table">
        <ul class="clearfix half-ul">
          <li class="condition_td fl half-li">
            <label>报案号显示</label>
            <div class="half-div">
              <ui-select  ng-required="true" ng-model="testComClaimDetailResDtolistdata"  on-select="showRegist($select.selected)">
                <ui-select-match   placeholder="查询或选择...">
                  {{$select.selected.registNo}}
                </ui-select-match>
                <ui-select-choices repeat="code in ComClaimList | filter: $select.search">
                  <span ng-bind="code.prpLClaimDtoExt.prpLClaimDto.registNo"></span>
                </ui-select-choices>
              </ui-select>
            </div>
          </li>
        </ul>

      </div>
    </div>
    <div class="queryCriteria mt20">
      <span class="queryCriteria_title">
                    <label>立案登记</label>
                </span>
      <div class="condition_table">
        <ul class="clearfix half-ul">
          <li class="condition_td fl half-li">
            <label>险种名称</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.riskName" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>报案号</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.registNo"  ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>保单号码</label>
            <div class="half-div">
              <input type="text"  ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.policyNo" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>立案号</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.claimNo" maxlength="19" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>已出险次数</label>
            <div class="half-div">
              <input type="text" class="danger_short" ng-model="ComClaimDetailResDto.intRecentCount" ng-disabled="true"/>
              <span class='fl danger_btn' ng-click="openPerilCount()">查看</span>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>被保险人姓名</label>
            <div class="half-div">
              <input type="text"  ng-model="ComClaimDetailResDto.prpLClaimDtoExt.insuredNameShow" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label><i class='i-col'>*</i>出险时间</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.damageStartDate" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label><i class='i-col'>*</i>出险地点</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.damageAddress" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label><i class='i-col'>*</i>币别</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.currency" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label><i class='i-col'>*</i>保险金额</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.sumAmount" ng-disabled="true"
                     ng-pattern="regData.positiveNumber"
                     warn-text="{'ErrPattern':'保险金额只能输入数字!',itemName:'保险金额'}"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label><i class='i-col'>*</i>出险原因</label>
            <div class="half-div">
              <ui-select  ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.damageCode" ng-disabled="seeFlag">
                <ui-select-match  allow-clear placeholder="查询或选择...">
                  {{$select.selected.codecname}}
                </ui-select-match>
                <ui-select-choices repeat="code.codecode as code in codeListData.DamageCode | filter: $select.search">
                  <span ng-bind="code.codecname"></span>
                </ui-select-choices>
              </ui-select>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>受损标的</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.lossName" ng-disabled="seeFlag">
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>是否可能有追偿</label>
            <div class="half-div">
              <code-type base-code="remark_flag" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.replevyFlag" ng-disabled="seeFlag" ></code-type>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>是否可有其他理赔机构</label>
            <div class="half-div">
              <code-type base-code="remark_flag" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.thirdComFlag" ng-disabled="seeFlag"></code-type>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>估损金额CNY</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.sumClaim" ng-disabled="true" ng-pattern="regData.positiveNumber"
                     warn-text="{'ErrPattern':'估损金额只能输入数字!',itemName:'估损金额'}"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>立案日期</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.claimDate" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>业务归属机构</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.comName" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>归属业务员</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.handler1Name" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>接报案人</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.operatorName" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label>理赔登记部门</label>
            <div class="half-div">
              <input type="text" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.makeCom" ng-disabled="true"/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label><i class='i-col'>*</i>赔付数量</label>
            <div class="half-div">
              <input type="text"
                     class="danger_short"
                     ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.lossesNumber"
                     ng-pattern="regData.number"
                     my-maxnumber="{{ComClaimDetailResDto.statQuantity}}"
                     warn-text="{myMaxnumber:'赔付数量不能大于承保数量','ErrPattern':'赔付数量格式错误请修改！',itemName:'赔付数量'}" name="lossEsnumBerrequired"
                     ng-disabled="seeFlag"
                     showText="赔付数量不能为空"
                     ng-change="ruleVerify('number',ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.lossesNumber,'lossEsnumBerrequired')"/>
              <!--<ui-select class="fl danger_select" ng-disabled="seeFlag" ng-required="true" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.lossesUnitCode"  >
                <ui-select-match  >
                  {{$select.selected.codecname}}
                </ui-select-match>
                <ui-select-choices style="min-width: 0;width: 100%"  repeat="code.codecode as code in codeListData.Unit | filter: $select.search">
                  <span ng-bind="code.codecname"></span>
                </ui-select-choices>
              </ui-select>-->
              <div class="select_arrow"><i class="caretSelf"></i></div>
              <select class="fl danger_select" ng-disabled="showFlag">
                <option>头</option>
              </select>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label><i class='i-col'>*</i>出险户次</label>
            <div class="half-div">
              <input type="text"
                     ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.damageInsured"
                     ng-pattern="regData.number"
                     warn-text="{'ErrPattern':'出险户次格式错误请修改！',itemName:'出险户次'}"
                     ng-disabled="seeFlag"
                     name="damageInsuredrequired"
                     ng-change="ruleVerify('number',ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.damageInsured,'damageInsuredrequired')"
                     required
                     showText='出险户次不能为空！'/>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label><i class='i-col'>*</i>死亡数量</label>
            <div class="half-div">
              <input type="text"
                     ng-pattern="regData.number"
                     warn-text="{'ErrPattern':'死亡数量格式错误请修改!',itemName:'死亡数量'}"
                     ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.deathQuantity"
                     class="danger_short" ng-disabled="seeFlag"/>
              <!--<ui-select class="fl danger_select" ng-disabled="seeFlag" ng-required="true" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.lossesUnitCode"  >
                <ui-select-match  >
                  {{$select.selected.codecname}}
                </ui-select-match>
                <ui-select-choices style="min-width: 0;width: 100%"  repeat="code.codecode as code in codeListData.Unit | filter: $select.search">
                  <span ng-bind="code.codecname"></span>
                </ui-select-choices>
              </ui-select>-->
              <div class="select_arrow"><i class="caretSelf"></i></div>
              <select class="fl danger_select" ng-disabled="showFlag">
                <option>头</option>
              </select>
            </div>
          </li>
          <li class="condition_td fl half-li">
            <label><i class='i-col'>*</i>扑杀数量</label>
            <div class="half-div">
              <input type="text"
                     ng-pattern="regData.number"
                     warn-text="{'ErrPattern':'扑杀数量格式错误请修改！',itemName:'扑杀数量'}"
                     class="danger_short"
                     ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.killQuantity"
                     ng-disabled="seeFlag"/>
              <!--<ui-select class="fl danger_select" ng-disabled="seeFlag" ng-required="true" ng-model="ComClaimDetailResDto.prpLClaimDtoExt.prpLClaimDto.lossesUnitCode"  >
                <ui-select-match  >
                  {{$select.selected.codecname}}
                </ui-select-match>
                <ui-select-choices style="min-width: 0;width: 100%"  repeat="code.codecode as code in codeListData.Unit | filter: $select.search">
                  <span ng-bind="code.codecname"></span>
                </ui-select-choices>
              </ui-select>-->
              <div class="select_arrow"><i class="caretSelf"></i></div>
              <select class="fl danger_select" ng-disabled="showFlag">
                <option>头</option>
              </select>
            </div>
          </li>
        </ul>
      </div>
    </div>
    <!--出险摘要-->
    <div class="content_div content1-div mt20">
      <div class="queryCriteria">
                <span class="queryCriteria_title">
                    <label>出险摘要</label>
                </span>
        <div class="condition_table mt20">
          <textarea class="w-textarea" rows="4" ng-model="ComClaimDetailResDto.context" ng-disabled="true"></textarea>
        </div>
      </div>
    </div>
    <!--险别估损金额信息-->
    <div class="queryResult pb10">
      <div class="queryResult_title clearfix">
        <span class="fl tit-color font-bold"><i class="i-col">*</i>险别估损金额信息</span>
        <label class="fr condition_label" ng-hide="seeFlag" ng-click="gatherSum()">汇总</label>
      </div>
      <table>
        <thead>
        <tr class="tr_top">
          <td class="w6">被保险人</td>
          <td class="w6">标的序号</td>
          <td class="w6">险别</td>
          <td class="w9">标的名称</td>
          <td class="w17td w10td">币别</td>
          <td class="w9">预计给付金额</td>
          <td class="w6">类别</td>
          <td class="w10">输入日期</td>
          <td class="w6">操作</td>
        </tr>
        </thead>
        <tbody>
        <tr class="tr_content" ng-repeat="result in ComClaimDetailResDto.prpLclaimLossDtoList">
          <td class="td-select">
            <ui-select  ng-required="true" ng-model="result.prpLClaimLossDto.familyName" ng-disabled="seeFlag">
              <ui-select-match   placeholder="查询或选择...">
                {{$select.selected.familyName}}
              </ui-select-match>
              <ui-select-choices repeat="code.familyName as code in codeListData.familyNameList | filter: $select.search">
                <span ng-bind="code.familyName"></span>
              </ui-select-choices>
            </ui-select>
          </td>
          <td ng-bind="$index+1"></td>
          <td class="td-select">
            <ui-select ng-disabled="seeFlag" ng-required="true" on-select="getItemDetailName(result, $select)" ng-model="result.prpLClaimLossDto.kindCode"  >
              <ui-select-match   placeholder="查询或选择...">
                {{$select.selected.kindName}}
              </ui-select-match>
              <ui-select-choices repeat="code.kindCode as code in codeListData.kindCodeList | filter: $select.search">
                <span ng-bind="code.kindName"></span>
              </ui-select-choices>
            </ui-select>
          </td>
          <td ng-bind="result.prpLClaimLossDto.itemDetailName"></td>
          <td  class="td-select">
            <code-type ng-model="result.prpLClaimLossDto.currency" base-code="Currency" ng-disabled="seeFlag" ng-init="CNY"></code-type>
          </td>

          <td>
            <input type="text" ng-model="result.prpLClaimLossDto.sumClaim" ng-disabled="seeFlag" ng-required="true"
                   name="sumClaimrequired"
                   ng-change="ruleVerify('number',result.prpLClaimLossDto.sumClaim,'sumClaimrequired')"
                  >
          </td>
          <td class="td-select">
            <code-type ng-model="result.prpLClaimLossDto.lossFeeType" ng-disabled="seeFlag" base-code="LossFeeType"></code-type>
          </td>
          <td ng-bind="result.prpLClaimLossDto.inputDate"></td>
          <td><a href="javascript:void(0)" class="remove-a" ng-hide="seeFlag" name="delLoss" ng-click="delLossList($index)">删除</a></td>
        </tr>
        </tbody>
        <tfoot>
        <tr class="tr_content">
          <td colspan="8" ng-show="!seeFlag"></td>
          <td colspan="9" ng-show="seeFlag"></td>
          <td class='local-sec' ng-hide="seeFlag" ng-click="addLossList()">添加</td>
        </tr>
        </tfoot>
      </table>
    </div>
    <div class="btn_tr mt20" ng-show="!seeFlag">
      <span ng-click="saveComClaim('sub')">暂存</span>
      <span class="btn"  ng-disabled="flag" ng-click="saveComClaim('save')">提交</span>
      <span ng-click="cancel()">取消</span>
    </div>
    <div class="btn_tr mt20" ng-show="seeFlag">
      <span ng-click="goBack()">返回</span>
    </div>
  </div>
</div>
<!--理赔沟通弹层-->
<!--<div ui-view="communication"></div>-->
<!--电子单证弹层-->
<!--<div ui-view="eleDocument"></div>-->
