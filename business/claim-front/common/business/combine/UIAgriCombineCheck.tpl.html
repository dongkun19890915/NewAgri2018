<!--
****************************************************************************
* DESC       ：国元农险理赔并案查勘定损任务处理修改页面
* AUTHOR     ：国元农险项目组
* CREATEDATE ：2017/11/30
* MODIFYLIST ：Name        Date        Reason/Contents
* --------------------------------------------------------
****************************************************************************
-->
<div class="section" id="UIAgriCombineCheck_section">
    <div class="view-record">
        <span ng-click="openCommunicationLayer()">理赔沟通</span>
        <span ng-click="showElectronicDocu()">电子单证</span>
    </div>
    <div class="content_div content1-div">
        <div class="queryCriteria mo-heigh">
            <span class="queryCriteria_title">
                    <label>并案列表</label>
                    <div ng-click="searchConditionShow=!searchConditionShow" class="cur fr">
                        <i class="iconfont click_img reduce">&#xe667;</i>
                        <i class="iconfont click_img plus"></i>
                    </div>
                </span>
            <div class="condition_table">
                <ul class="clearfix half-ul">
                    <li class="condition_td fl half-li">
                        <label>报案号显示</label>
                        <div class="half-div">
                            <ui-select  ng-required="true" ng-model="testResponseNewDtolistdata"   on-select="showRegist($select.selected)">
                                <ui-select-match   placeholder="查询或选择...">
                                    {{$select.selected.registNo}}
                                </ui-select-match>
                                <ui-select-choices repeat="code in ResponseNewDto | filter: $select.search">
                                    <span ng-bind="code.registNo"></span>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </li>
                </ul>

            </div>
        </div>
        <div class="queryDanger">
                <span class="queryCriteria_title">
                    <label>查勘定损</label>
                    <div ng-click="searchConditionShow=!searchConditionShow" class="cur fr">
                        <i class="iconfont click_img reduce">&#xe667;</i>
                        <i class="iconfont click_img plus"></i>
                    </div>
                </span>
            <div class="condition_table">
                <ul class="clearfix half-ul">
                    <li class="condition_td fl half-li">
                        <label>险种名称</label>
                        <div class="half-div">
                            <input  type="text" ng-model="ResponseDto.prpLcheckDtoExt.riskName" ng-disabled="true"/>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>报案号</label>
                        <div class="half-div">
                            <input  type="text" maxlength="19" ng-model="ResponseDto.registNo" ng-disabled="true"/>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>保单号码</label>
                        <div class="half-div">
                            <input  type="text" class="danger_short" maxlength="19" ng-disabled="true" ng-model="ResponseDto.policyNo" />
                            <span class='fl danger_btn' ng-click="showRelateInfo()">关联</span>
                        </div>
                    </li>
                    <!--<li class="condition_td fl half-li">
                        <label>立案号</label>
                        <div class="half-div">
                            <input  type="text" ng-model="ResponseDto.claimNo" maxlength="19" ng-disabled="true"/>
                        </div>
                    </li>-->
                    <li class="condition_td fl half-li">
                        <label>已出险次数</label>
                        <div class="half-div">
                            <input type="text" class="danger_short" ng-disabled="true" ng-model="ResponseDto.intRecentCount"/>
                            <span class='fl danger_btn' ng-click="openPerilCount()">查看</span>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>被保险人名称</label>
                        <div class="half-div">
                            <input  type="text" ng-model="ResponseDto.prpLcheckDtoExt.insuredName" ng-disabled="true"/>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>出险时间</label>
                        <div class="half-div">
                            <input  type="text" ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.damageStartDate" ng-disabled="true"/>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>出险地点</label>
                        <div class="half-div">
                            <input ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.damageAddress" type="text" ng-disabled="seeFlag"/>
                        </div>
                    </li>
                    <li class="condition_td fl half-li ">
                        <label>查勘性质</label>
                        <div class="half-div">
                            <code-type base-code="CheckNature" ng-disabled="seeFlag" ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.checkNature"></code-type>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label><i class="i-col">*</i>查勘日期</label>
                        <div class="half-div">
                            <input ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.checkDate" type="text" ng-disabled="seeFlag"/>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label><i class="i-col">*</i>查勘地点</label>
                        <div class="half-div">
                            <input ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.checkSite" type="text"ng-disabled="seeFlag" />
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label><i class="i-col">*</i>查勘人1</label>
                        <div class="half-div">
                            <input type="text"  ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.checker1"  ng-disabled="seeFlag" />
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>查勘人2</label>
                        <div class="half-div">
                            <input type="text"  ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.checker2" ng-disabled="seeFlag"/>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label><i class="i-col">*</i>出险原因</label>
                        <div class="half-div">
                            <ui-select ng-disabled="seeFlag" ng-required="true" ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.damageCode"  >
                                <ui-select-match   placeholder="查询或选择...">
                                    {{$select.selected.codecname}}
                                </ui-select-match>
                                <ui-select-choices repeat="code.codecode as code in codeListData.DamageCode | filter: $select.search">
                                    <span ng-bind="code.codecname"></span>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>报损金额CNY</label>
                        <div class="half-div">
                            <input type="text" ng-model="ResponseDto.prpLcheckDtoExt.registEstimateLoss" ng-pattern="regData.positiveNumber"
                                   ng-pattern="regData.positiveNumber"
                                   warn-text="{'ErrPattern':'报损金额只能输入数字!',itemName:'报损金额'}"
                                   ng-disabled="seeFlag" />
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>预估金额CNY</label>
                        <div class="half-div">
                            <input type="text"  ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.estimateLoss" ng-disabled="seeFlag"
                                   ng-pattern="regData.positiveNumber"
                                   maxlength="10"
                                   warn-text="{'ErrPattern':'预估金额只能输入数字!',itemName:'预估金额'}"/>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>查勘处理单位</label>
                        <div class="half-div">
                            <com-tree ng-value="ResponseDto.prpLcheckDtoExt.prpLCheckDto.handleUnit" url="queryUnit"  user="user" ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.handleUnitCode"  ng-disabled="seeFlag" class="tree"></com-tree>
                            <input type="hidden" ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.handleUnit">
                        </div>
                    </li>
                    <li class="condition_td fl long-li">
                        <label>备注</label>
                        <div class="half-div ">
                            <textarea   row="2" ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.remark" style="height: 70px;width:93%;border-radius: 3px"  ng-disabled="seeFlag">

                            </textarea>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="queryDanger">
                <!--<span class="queryCriteria_title">
                    <label>查勘定损登记</label>
                    <div ng-click="searchConditionShow=!searchConditionShow" class="cur fr">
                        <i class="iconfont click_img reduce">&#xe667;</i>
                        <i class="iconfont click_img plus"></i>
                    </div>
                </span>-->
            <div class="clearfix" style="border-bottom: 1px solid #d7d7d7;">
                <span class="queryCriteria_title fl" style="width:40%;">
                    <label>查勘定损登记</label>
                </span>
                <div class="btn_tr clearfix mt20 pl13 fr" style="margin-top:4px !important;padding:0;width:26%;">
                    <span ng-click="importlist()" >导入定损清单</span>
                    <span ng-click="downloadlist()" >下载清单</span>
                </div>
            </div>
            <div class="condition_table">
                <ul class='clearfix half-ul'>
                    <li class="condition_td fl half-li">
                        <label>定损时间</label>
                        <div class="half-div">
                            <input ng-model="ResponseDto.prpLverifyLossDto.underWriteEndDate"
                                   type="text"
                                   jedate
                                   class="date"
                                   ng-disabled="seeFlag"
                                   id="underWriteEndDate"
                                   name="underWriteEndDate1required"
                                   required
                                   showText="定损时间不能为空"
                                   format="YYYY-MM-DD"/>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>赔付数量</label>
                        <div class="half-div">
                            <input ng-model="ResponseDto.prpLverifyLossDto.lossEsnumBer"
                                   class="danger_short" value="1" type="text" ng-disabled="seeFlag"
                                   my-maxnumber="{{ResponseDto.statQuantity}}"
                                   warn-text="{myMaxnumber:'赔付数量不能大于承保数量'}" name="lossEsnumBerrequired"
                                   ng-required="true" showText="赔付数量不能为空"
                                   ng-change="ruleVerify('number',ResponseDto.prpLverifyLossDto.lossEsnumBer,'lossEsnumBerrequired')"/>
                            <!--<ui-select class="fl danger_select" ng-disabled="seeFlag" ng-required="true" ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.unitType"  >
                                <ui-select-match  >
                                    {{$select.selected.codecname}}
                                </ui-select-match>
                                <ui-select-choices style="min-width: 0;width: 100%"  repeat="code.codecode as code in codeListData.Unit | filter: $select.search">
                                    <span ng-bind="code.codecname"></span>
                                </ui-select-choices>
                            </ui-select>-->
                            <div class="select_arrow"><i class="caretSelf"></i></div>
                            <select class="fl danger_select" ng-disabled="seeFlag">
                                <option>头</option>
                            </select>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>出险户次</label>
                        <div class="half-div">
                            <input ng-model="ResponseDto.prpLverifyLossDto.damageInsured" type="text" ng-disabled="seeFlag"
                                   name="damageInsuredrequired" ng-change="ruleVerify('number',ResponseDto.prpLverifyLossDto.damageInsured,'damageInsuredrequired')" required showText="出险户次不能为空"/>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>死亡数量</label>
                        <div class="half-div">
                            <input ng-model="ResponseDto.prpLverifyLossDto.deathQuantity" class="danger_short" type="text" ng-disabled="seeFlag" name="deathQuantityrequired" required showText="死亡数量不能为空"/>
                            <!--<ui-select class="fl danger_select" ng-disabled="seeFlag" ng-required="true" ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.unitType"  >
                                <ui-select-match  >
                                    {{$select.selected.codecname}}
                                </ui-select-match>
                                <ui-select-choices style="min-width: 0;width: 100%"  repeat="code.codecode as code in codeListData.Unit | filter: $select.search">
                                    <span ng-bind="code.codecname"></span>
                                </ui-select-choices>
                            </ui-select>-->
                            <div class="select_arrow"><i class="caretSelf"></i></div>
                            <select class="fl danger_select" ng-disabled="seeFlag">
                                <option>头</option>
                            </select>
                        </div>
                    </li>
                    <li class="condition_td fl half-li">
                        <label>扑杀数量</label>
                        <div class="half-div">
                            <input ng-model="ResponseDto.prpLverifyLossDto.killQuantity" class="danger_short" type="text" ng-disabled="seeFlag" name="killQuantityrequired" required showText="扑杀数量不能为空" />
                            <!--<ui-select class="fl danger_select" ng-disabled="seeFlag" ng-required="true" ng-model="ResponseDto.prpLcheckDtoExt.prpLCheckDto.unitType"  >
                                <ui-select-match  >
                                    {{$select.selected.codecname}}
                                </ui-select-match>
                                <ui-select-choices style="min-width: 0;width: 100%"  repeat="code.codecode as code in codeListData.Unit | filter: $select.search">
                                    <span ng-bind="code.codecname"></span>
                                </ui-select-choices>
                            </ui-select>-->
                            <div class="select_arrow"><i class="caretSelf"></i></div>
                            <select class="fl danger_select" ng-disabled="seeFlag">
                                <option>头</option>
                            </select>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="queryDanger">
                <span class="queryCriteria_title">
                    <label>查勘定损报告</label>
                </span>
            <div class="input-content-box">
                <textarea rows="4" ng-disabled="seeFlag" ng-model="ResponseDto.context">

                </textarea>
            </div>
        </div>
        <div class="btn_tr clearfix mt20" ng-show="!seeFlag">
            <span ng-click="submitCheck('save')">暂存</span>
            <span class="btn"  ng-disabled="flag" ng-click="submitCheck('sub')">提交</span>
            <span ng-click="cancel()">取消</span>
        </div>
        <div class="btn_tr clearfix mt20" ng-show="seeFlag">
            <span ng-click="goBack()">返回</span>
        </div>
    </div>
</div>
<!-- 关联弹层-->
<!--<div ui-view="connect"></div>-->
<div class="orderlayerBox" style="max-height:700px " ng-show="relateInfo">
    <div class="mask zIndex"></div>
    <div class="tip_success_info printLayer orderIntLayer">
        <div class="remove_header">
            <span>保单信息</span>
            <i class="icon iconfont" ng-click="closeRelative()">&#xe632;</i>
        </div>
        <div class="info_container">
            <div >
                <!--<div class="remove_header">-->
                <!--<span>保单信息</span>-->
                <!--</div>-->
                <div class="condition_table">
                    <ul class="clearfix">
                        <li class="condition_td fl long-li">
                            <label>保单号</label>
                            <input type="text" style="width: 37%" ng-model="relateInfoDto.prpCmainDto.policyNo" disabled="disabled">
                            <span class='fl danger_btn' ng-click="policyShow(CheckPageResponseDto.prpLcheckDto.policyNo)">出险时保单信息</span>
                        </li>
                        <li class="condition_td fl long-li">
                            <label>保险期限</label>
                            <!--<input type="text" ng-model="relateInfoDto.prpCmainDto.insuredName"  maxlength="19" disabled="disabled">-->
                            <div class="data-box">
                                <input type="text" id="startDate" style="width: 30%" class="date-long-input fl date" ng-model="relateInfoDto.prpCmainDto.startDate" jedate format="YYYY-MM-DD" ng-disabled="true"/>
                                <span class='fl long-span'>零时起至</span>
                                <input type="text" id="endDate" style="width: 30%" class="date-long-input fl date" ng-model="relateInfoDto.prpCmainDto.endDate" jedate format="YYYY-MM-DD" ng-disabled="true"/>
                                <span class='fl'>二十四时止</span>
                            </div>
                        </li>
                        <li class="condition_td fl long-li">
                            <label>被保险人名称</label><input type="text" style="width: 37%" ng-model="relateInfoDto.prpCmainDto.insuredName"  disabled="disabled">
                        </li>
                    </ul>
                </div>
            </div>
            <div class="queryCriteria" style="border-top: none;width: 100%;">
                <div class="remove_header">
                    <span>批单信息</span>
                </div>
                <table class="condition_table" style="margin-top: 0px">
                    <tr class="tr_top">
                        <td class="w8">序号</td>
                        <td class="w8">批单号码</td>
                        <td class="w8">核批完成日期</td>
                    </tr>
                    <tr class="tr_content F2F2F2" ng-repeat="result in relateInfoDto.prpPheadDtoList">
                        <td ng-bind="$index+1"></td>
                        <td ng-bind="result.endorseNo" ></td>
                        <td ng-bind="result.underwriteEndDate"></td>
                    </tr>
                </table>
            </div>
            <div class="queryCriteria" style="border-top: none;width: 100%;">
                <div class="remove_header">
                    <span>理赔信息</span>
                </div>
                <table class="condition_table" style="margin-top: 0px">
                    <thead>
                    <tr class="tr_top">
                        <td class="w8">序号</td>
                        <td class="w8">报案号</td>
                        <td class="w8">出险时间</td>
                        <td class="w8">赔付金额</td>
                        <td class="w8">流程图</td>
                    </tr>
                    </thead>
                    <tbody  style="height: 100px;overflow-y: scroll;">
                    <tr class="tr_content F2F2F2" style="height: 42px;line-height: 42px;" ng-repeat="result in relateInfoDto.prpLregistDtoList">
                        <td ng-bind="$index+1"></td>
                        <td ng-bind="result.registNo" ></td>
                        <td ng-bind="result.damageStartDate"></td>
                        <td ng-bind="result.estimateLoss"></td>
                        <td class="local-sec" ng-click="showFlow(result)">查看</td>
                    </tr>
                    </tbody >
                </table>
            </div>
        </div>
    </div>
</div>
